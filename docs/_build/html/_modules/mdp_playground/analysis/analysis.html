
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mdp_playground.analysis.analysis &#8212; MDP Playground 0.0.1 documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      <h1 class="site-logo" id="site-title">MDP Playground 0.0.1 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../_autosummary/mdp_playground.html">
   mdp_playground
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../_autosummary/mdp_playground.analysis.html">
     mdp_playground.analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.analysis.analysis.html">
       mdp_playground.analysis.analysis
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html">
         mdp_playground.analysis.analysis.MDPP_Analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.analysis.radar_chart.html">
       mdp_playground.analysis.radar_chart
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.analysis.radar_chart.radar_factory.html">
         mdp_playground.analysis.radar_chart.radar_factory
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../_autosummary/mdp_playground.config_processor.html">
     mdp_playground.config_processor
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.html">
     mdp_playground.envs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.gym_env_wrapper.html">
       mdp_playground.envs.gym_env_wrapper
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.gym_env_wrapper.GymEnvWrapper.html">
         mdp_playground.envs.gym_env_wrapper.GymEnvWrapper
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.mujoco_env_wrapper.html">
       mdp_playground.envs.mujoco_env_wrapper
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.mujoco_env_wrapper.get_mujoco_wrapper.html">
         mdp_playground.envs.mujoco_env_wrapper.get_mujoco_wrapper
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.rl_toy_env.html">
       mdp_playground.envs.rl_toy_env
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.rl_toy_env.dist_of_pt_from_line.html">
         mdp_playground.envs.rl_toy_env.dist_of_pt_from_line
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.rl_toy_env.list_to_float_np_array.html">
         mdp_playground.envs.rl_toy_env.list_to_float_np_array
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.envs.rl_toy_env.RLToyEnv.html">
         mdp_playground.envs.rl_toy_env.RLToyEnv
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../_autosummary/mdp_playground.scripts.html">
     mdp_playground.scripts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.scripts.run_experiments.html">
       mdp_playground.scripts.run_experiments
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.scripts.run_experiments.cli.html">
         mdp_playground.scripts.run_experiments.cli
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.scripts.run_experiments.main.html">
         mdp_playground.scripts.run_experiments.main
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.html">
     mdp_playground.spaces
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.box_extended.html">
       mdp_playground.spaces.box_extended
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.box_extended.BoxExtended.html">
         mdp_playground.spaces.box_extended.BoxExtended
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.discrete_extended.html">
       mdp_playground.spaces.discrete_extended
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.discrete_extended.DiscreteExtended.html">
         mdp_playground.spaces.discrete_extended.DiscreteExtended
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.image_continuous.html">
       mdp_playground.spaces.image_continuous
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.image_continuous.ImageContinuous.html">
         mdp_playground.spaces.image_continuous.ImageContinuous
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.image_multi_discrete.html">
       mdp_playground.spaces.image_multi_discrete
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
      <label for="toctree-checkbox-15">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.image_multi_discrete.ImageMultiDiscrete.html">
         mdp_playground.spaces.image_multi_discrete.ImageMultiDiscrete
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.multi_discrete_extended.html">
       mdp_playground.spaces.multi_discrete_extended
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.multi_discrete_extended.MultiDiscreteExtended.html">
         mdp_playground.spaces.multi_discrete_extended.MultiDiscreteExtended
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.test_image_continuous.html">
       mdp_playground.spaces.test_image_continuous
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.test_image_continuous.TestImageContinuous.html">
         mdp_playground.spaces.test_image_continuous.TestImageContinuous
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.test_image_multi_discrete.html">
       mdp_playground.spaces.test_image_multi_discrete
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
      <label for="toctree-checkbox-18">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.test_image_multi_discrete.TestImageMultiDiscrete.html">
         mdp_playground.spaces.test_image_multi_discrete.TestImageMultiDiscrete
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.tuple_extended.html">
       mdp_playground.spaces.tuple_extended
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../_autosummary/mdp_playground.spaces.tuple_extended.TupleExtended.html">
         mdp_playground.spaces.tuple_extended.TupleExtended
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <h1>Source code for mdp_playground.analysis.analysis</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">radar_chart</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">math</span>

<div class="viewcode-block" id="MDPP_Analysis"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis">[docs]</a><span class="k">class</span> <span class="nc">MDPP_Analysis</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Utility class to load and plot data for analysis of experiments from MDP Playground</span>

<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="MDPP_Analysis.__init__"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="MDPP_Analysis.load_data"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">load_eval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Loads training and evaluation data from given multiple files</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        experiments : dict&lt;str,str&gt;</span>
<span class="sd">            per experiment -&gt; key-value pair of exp_name &amp; dir_name</span>

<span class="sd">            dir_name : str</span>
<span class="sd">                The location where the training and evaluation CSV files were written</span>
<span class="sd">            exp_name : str</span>
<span class="sd">                The name of the experiment: the training and evaluation CSV filenames are formed using this string</span>

<span class="sd">            eg: experiments = {</span>
<span class="sd">                    &quot;td3_move_to_a_point_action_max&quot;: &quot;&lt;path_to_data_dir&gt;&quot;,</span>
<span class="sd">                    .....</span>
<span class="sd">                }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            list of experiment data of type &lt;dict&gt;</span>
<span class="sd">            [ for more details refer get_exp_data() ]</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">list_exp_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">exp_name</span><span class="p">,</span> <span class="n">dir_name</span> <span class="ow">in</span> <span class="n">experiments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">exp_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exp_data</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="n">exp_name</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="n">exp_type</span><span class="p">,</span> <span class="n">load_eval</span><span class="o">=</span><span class="n">load_eval</span><span class="p">)</span>
            <span class="n">list_exp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_exp_data</span></div>

<div class="viewcode-block" id="MDPP_Analysis.get_exp_data"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.get_exp_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_exp_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">exp_name</span><span class="p">,</span> <span class="n">exp_type</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="n">num_metrics</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">load_eval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">sample_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                    <span class="c1">#, max_total_configs=200):</span>
        <span class="sd">&#39;&#39;&#39;Get training and evaluation data from a single set of recorded CSV stats files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_name : str</span>
<span class="sd">            The location where the training and evaluation CSV files were written</span>
<span class="sd">        exp_name : str</span>
<span class="sd">            The name of the experiment: the training and evaluation CSV filenames are formed using this string</span>
<span class="sd">        exp_type : str</span>
<span class="sd">            One of [&#39;grid&#39;, &#39;random&#39;]. If it&#39;s &#39;grid&#39;, it&#39;s assumed that a grid of configurations was run and data loading takes place in a manner specific to grids. Otherwise, data loading tries to look for different unique configurations run.</span>
<span class="sd">        num_metrics : int</span>
<span class="sd">            The number of metrics that were written to CSV stats files. Default is 3 (timesteps_total, episode_reward_mean, episode_len_mean).</span>
<span class="sd">        load_eval : bool</span>
<span class="sd">            Whether to load evaluation stats CSV or not.</span>
<span class="sd">        threshold : float</span>
<span class="sd">            The fault tolerance threshold while loading data. Show warnings for files where the number of data rows deviates by more than the threshold value (from the mean number of rows across the loaded files), e.g., if the threshold = 0.05 and mean number of rows across the loaded files = 20, a warning is displayed when for a loaded file the number of rows &lt; 19.</span>
<span class="sd">        sample_freq : int</span>
<span class="sd">            The subsampling frequency when loading data. Sub-select data lines based on this value, e.g., if sample_freq = 5, load every 5th row in a file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        experiment data: dictionary type with following key-value</span>

<span class="sd">        train_stats : np.ndarray</span>
<span class="sd">            Training stats at end of training: 8-D tensor with 1st 6 dims the dimensions of hardness of MDP Playground, 7th dim is across the seeds, 8th dim is across different stats saved</span>
<span class="sd">        eval_stats : np.ndarray</span>
<span class="sd">            Training stats at end of training: 8-D tensor with 1st 6 dims the dimensions of hardness of MDP Playground, 7th dim is across the seeds, 8th dim is across different stats saved</span>
<span class="sd">        train_curves: np.ndarray</span>
<span class="sd">            The loaded training CSV with the last 3 columns the train stats that were saved and the initial columns are various setting for the algorithm and environment.</span>
<span class="sd">        eval_curves: np.ndarray</span>
<span class="sd">            The loaded evaluation CSV with the columns the evaluation stats that were saved</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">stats_file</span> <span class="o">=</span> <span class="n">dir_name</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">exp_name</span> <span class="c1">#Name of file to which benchmark stats were written</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_file</span> <span class="o">=</span> <span class="n">stats_file</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">stats_file</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1;31mLoading data from a sequential run/already combined runs of experiment configurations:</span><span class="se">\033</span><span class="s2">[0;0m &quot;</span> <span class="o">+</span> <span class="n">stats_file</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading data from a distributed run of experiment configurations. Creating a combined CSV stats file.&quot;</span><span class="p">)</span>
            <span class="n">train_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">eval_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="k">def</span> <span class="nf">join_files</span><span class="p">(</span><span class="n">file_prefix</span><span class="p">,</span> <span class="n">file_suffix</span><span class="p">):</span>
                <span class="sd">&#39;&#39;&#39;Utility to join files that were written with different experiment configs&#39;&#39;&#39;</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_prefix</span> <span class="o">+</span> <span class="n">file_suffix</span><span class="p">,</span> <span class="s1">&#39;ab&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">combined_file</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">missing_configs</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">num_diff_lines</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># i &lt; max_total_configs:</span>
                        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">file_suffix</span><span class="p">):</span>
                            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_prefix</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">file_suffix</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">curr_file</span><span class="p">:</span>
                                <span class="n">byte_string</span> <span class="o">=</span> <span class="n">curr_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                                <span class="n">newline_count</span> <span class="o">=</span> <span class="n">byte_string</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                                <span class="n">num_diff_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newline_count</span><span class="p">)</span>
                                <span class="n">combined_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">byte_string</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">file_suffix</span> <span class="o">==</span> <span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
                                    <span class="c1"># train data</span>
                                    <span class="n">train_data</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">curr_file</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newline_count</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="c1"># eval data</span>
                                    <span class="n">eval_data</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">curr_file</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newline_count</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># missing_configs.append(i)</span>
                            <span class="k">break</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; files were combined into 1 for file:&quot;</span> <span class="o">+</span> <span class="n">file_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span> <span class="o">+</span> <span class="n">file_suffix</span><span class="p">)</span>
                    <span class="c1"># print(&quot;Files missing for config_nums:&quot;, missing_configs, &quot;. Did you pass the right value for max_total_configs as an argument?&quot;)</span>
                    <span class="c1"># print(&quot;Unique line count values:&quot;, np.unique(num_diff_lines))</span>
                    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;No files to combine were present. Please check your location and/or filenames that they are correct. Filename passed: &quot;</span> <span class="o">+</span> <span class="n">file_prefix</span> <span class="o">+</span> <span class="n">file_suffix</span><span class="p">)</span>
            <span class="n">join_files</span><span class="p">(</span><span class="n">stats_file</span><span class="p">,</span>  <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
            <span class="n">join_files</span><span class="p">(</span><span class="n">stats_file</span><span class="p">,</span> <span class="s1">&#39;_eval.csv&#39;</span><span class="p">)</span>

            <span class="n">train_mean_cnt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">eval_mean_cnt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">eval_data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

            <span class="c1"># fault tolerance check</span>
            <span class="k">for</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">line_count</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">line_count</span> <span class="o">&lt;</span> <span class="n">train_mean_cnt</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Expected a minimum of </span><span class="si">{0}</span><span class="s1"> rows in each stats file. Got only: </span><span class="si">{1}</span><span class="s1"> in file: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train_mean_cnt</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">),</span> <span class="n">line_count</span><span class="p">,</span> <span class="n">file_name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">line_count</span> <span class="ow">in</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">line_count</span> <span class="o">&lt;</span> <span class="n">eval_mean_cnt</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Expected a minimum of </span><span class="si">{0}</span><span class="s1"> rows in each stats file. Got only: </span><span class="si">{1}</span><span class="s1"> in file: </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eval_mean_cnt</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">),</span> <span class="n">line_count</span><span class="p">,</span> <span class="n">file_name</span><span class="p">))</span>

        <span class="c1"># Read column names</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">stats_file</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
            <span class="n">col_names</span> <span class="o">=</span> <span class="n">file_</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
            <span class="n">col_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">col_names</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># to remove &#39;# &#39; that was written</span>
        <span class="c1"># print(&quot;config_names:&quot;, col_names)</span>

        <span class="n">stats_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">stats_file</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">skip_blank_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">col_names</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="c1"># subsampling code</span>
        <span class="n">stats_pd_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="n">sample_freq</span><span class="p">)</span>
        <span class="n">stats_pd</span> <span class="o">=</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">stats_pd_indices</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats_pd</span> <span class="o">=</span> <span class="n">stats_pd</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training stats read (rows, columns):&quot;</span><span class="p">,</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">config_counts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dims_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Keep only config_names that we want to measure</span>
        <span class="c1"># traning iteration is always first, metrics are always last.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_config_names</span> <span class="o">=</span> <span class="n">col_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">full_config_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_config_names</span>
        <span class="n">full_config_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;training_iteration&quot;</span><span class="p">)</span>


        <span class="c1">#config counts includes seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed_idx</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># seed used to be fixed as the last, i.e.,</span>
        <span class="c1"># quickest varying dimension in the &lt;experiment config&gt;.py file&#39;s</span>
        <span class="c1"># config space because then all runs on a single env would be recorded</span>
        <span class="c1"># consecutively in the stats CSV</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_idx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">full_config_names</span><span class="p">[:</span><span class="o">-</span><span class="n">num_metrics</span><span class="p">]):</span>
            <span class="n">dims_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats_pd</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
            <span class="n">config_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats_pd</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
            <span class="k">if</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">):</span> <span class="c1"># ##TODO this will just set seed index to be</span>
            <span class="c1"># the &quot;last&quot; column name with seed in it.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seed_idx</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;timesteps_total&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ts_idx</span> <span class="o">=</span> <span class="n">i</span>


        <span class="n">config_counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_metrics</span><span class="p">)</span> <span class="c1"># #hardcoded number of training</span>
        <span class="c1"># stats that were recorded</span>
        <span class="n">config_counts</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">config_counts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_names</span> <span class="o">=</span> <span class="n">full_config_names</span><span class="p">[</span><span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_names</span> <span class="o">=</span> <span class="n">full_config_names</span><span class="p">[:</span><span class="o">-</span><span class="n">num_metrics</span><span class="p">]</span>

        <span class="c1"># Slice into training stats and get end of training stats for</span>
        <span class="c1"># individual training runs in the experiment</span>
        <span class="n">final_rows_for_a_config</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">previous_i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">list_of_learning_curves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># cols_to_take = 8</span>

        <span class="c1">#Finding end configuration training</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">stats_pd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">stats_pd</span><span class="p">[</span><span class="s2">&quot;timesteps_total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">stats_pd</span><span class="p">[</span><span class="s2">&quot;timesteps_total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">final_rows_for_a_config</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># print(&quot;i, previous_i:&quot;, i, previous_i)</span>
        <span class="n">final_rows_for_a_config</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Always append the last row!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span> <span class="o">=</span> <span class="n">final_rows_for_a_config</span>
        <span class="n">stats_end_of_training</span> <span class="o">=</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_rows_for_a_config</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span>
            <span class="n">train_stats</span> <span class="o">=</span> <span class="n">stats_end_of_training</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span> <span class="c1"># last vals are timesteps_total, episode_reward_mean, episode_len_mean</span>
            <span class="n">train_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_stats</span><span class="p">),</span> <span class="n">config_counts</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">train_stats</span> <span class="o">=</span> <span class="n">stats_end_of_training</span> <span class="c1"># Includes config values within dataframe as opposed to only perf. metrics for the grid case above</span>
            <span class="c1"># train_stats = stats_end_of_training.iloc[:, -num_metrics:] # Saves space by not including config values. # last vals are timesteps_total, episode_reward_mean, episode_len_mean ### TODO remove</span>

            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please check exp_type passed. Was:&#39;</span> <span class="o">+</span> <span class="n">exp_type</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train stats shape:&quot;</span><span class="p">,</span> <span class="n">train_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1"># Calculate AUC metrics</span>
        <span class="n">train_aucs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final_rows_for_a_config</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">to_avg_</span> <span class="o">=</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">to_avg_</span> <span class="o">=</span> <span class="n">stats_pd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span>
            <span class="n">auc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">to_avg_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">train_aucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
            <span class="c1"># print(auc)</span>
        <span class="n">train_aucs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_aucs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span>
            <span class="n">train_aucs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">train_aucs</span><span class="p">,</span> <span class="n">config_counts</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">train_aucs_</span> <span class="o">=</span> <span class="n">train_stats</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">train_aucs_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span> <span class="o">=</span> <span class="n">train_aucs</span>
            <span class="n">train_aucs</span> <span class="o">=</span> <span class="n">train_aucs_</span>
            <span class="k">pass</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train_aucs.shape:&quot;</span><span class="p">,</span> <span class="n">train_aucs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


        <span class="c1"># Load evaluation stats</span>
        <span class="n">eval_stats</span><span class="p">,</span> <span class="n">mean_data_eval</span><span class="p">,</span> <span class="n">eval_aucs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="c1"># load_eval = False # hack #### TODO rectify</span>
        <span class="k">if</span> <span class="n">load_eval</span><span class="p">:</span>
            <span class="n">stats_file_eval</span> <span class="o">=</span> <span class="n">stats_file</span> <span class="o">+</span> <span class="s1">&#39;_eval.csv&#39;</span>
            <span class="n">eval_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">stats_file_eval</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="c1"># print(eval_stats, eval_stats.shape)</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">hack_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">stats_file_eval</span><span class="p">):</span>

                <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1">#    print(line)</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#HACK&quot;</span><span class="p">):</span>
            <span class="c1">#         print(line, i)</span>
                    <span class="n">hack_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">hack_indices</span><span class="p">))</span> <span class="c1"># appends index of last eval in this training_iteration</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># print(&quot;len(hack_indices), hack_indices[:5] and [:-5]:&quot;, len(hack_indices), hack_indices[:5], hack_indices[-5:])</span>
            <span class="k">if</span> <span class="n">hack_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#hack</span>
                <span class="n">hack_indices</span> <span class="o">=</span> <span class="n">hack_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1">#hardcoded removes the 1st hack_index which is at position 0 so that hack_indices_10 below doesn&#39;t begin with a -10; apparently Ray seems to have changed logging for evaluation (using on_episode_end) from 0.7.3 to 0.9.0</span>
                <span class="n">ray_0_9_0</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ray_0_9_0</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">hack_indices_10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hack_indices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>
            <span class="c1"># print(hack_indices_10.shape, hack_indices_10[:5], hack_indices_10[-5:])</span>
            <span class="c1"># print(np.array(hack_indices[1:]) - np.array(hack_indices[:-1]))</span>
            <span class="c1"># print(&quot;Min:&quot;, min(np.array(hack_indices[1:]) - np.array(hack_indices[:-1]))) # Some problem with Ray? Sometimes no. of eval episodes is less than 10.</span>
            <span class="n">final_10_evals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hack_indices</span><span class="p">)):</span>
                <span class="n">final_10_evals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_stats</span><span class="p">[</span><span class="n">hack_indices_10</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">hack_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="c1">#     print(final_10_evals[-1])</span>
            <span class="k">if</span> <span class="n">ray_0_9_0</span><span class="p">:</span> <span class="c1">#hack</span>
                <span class="n">final_10_evals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_stats</span><span class="p">[</span><span class="n">hack_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]:])</span> <span class="c1"># appends the very last eval which begins at last hack_index for Ray 0.9.0</span>

            <span class="n">final_10_evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">final_10_evals</span><span class="p">)</span> <span class="c1"># has 2 columns: episode reward and episode length</span>
            <span class="c1"># print(final_10_evals.shape, final_10_evals)</span>


            <span class="c1"># final_vals = fin[final_rows_for_a_config]</span>
            <span class="c1"># print(&#39;final_rows_for_a_config&#39;, final_rows_for_a_config)</span>
            <span class="c1"># print(&quot;len(final_10_evals)&quot;, final_10_evals.shape, type(final_10_evals))</span>
            <span class="n">mean_data_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">final_10_evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># this is mean over last 10 eval episodes</span>

            <span class="c1"># subsampling code</span>
            <span class="n">eval_stats_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mean_data_eval</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="n">sample_freq</span><span class="p">)</span>
            <span class="n">mean_data_eval</span> <span class="o">=</span> <span class="n">mean_data_eval</span><span class="p">[</span><span class="n">eval_stats_indices</span><span class="p">]</span>

            <span class="c1"># Adds timesteps_total column to the eval stats which did not have them:</span>
            <span class="n">mean_data_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stats_pd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mean_data_eval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">final_eval_metrics_</span> <span class="o">=</span> <span class="n">mean_data_eval</span><span class="p">[</span><span class="n">final_rows_for_a_config</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># 1st column is episode reward, 2nd is episode length in original _eval.csv file, here it&#39;s 2nd and 3rd after prepending timesteps_total column above.</span>
            <span class="c1"># print(dims_values, config_counts)</span>

            <span class="k">if</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span>
                <span class="n">eval_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">final_eval_metrics_</span><span class="p">,</span> <span class="n">config_counts</span><span class="p">)</span>
                <span class="c1"># print(final_eval_metrics_)</span>
            <span class="k">elif</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
                <span class="n">eval_stats</span> <span class="o">=</span> <span class="n">final_eval_metrics_</span>
                <span class="n">eval_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">num_metrics</span><span class="p">])),</span> <span class="n">eval_stats</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Includes config values within dataframe as opposed to only perf. metrics for the grid case above</span>

            <span class="n">eval_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">eval_stats</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">train_stats</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eval stats shape:&quot;</span><span class="p">,</span> <span class="n">eval_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


            <span class="c1"># Calculate AUC metrics</span>
            <span class="n">eval_aucs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final_rows_for_a_config</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">to_avg_</span> <span class="o">=</span> <span class="n">mean_data_eval</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">to_avg_</span> <span class="o">=</span> <span class="n">mean_data_eval</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span>
                <span class="n">auc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">to_avg_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">eval_aucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
                <span class="c1"># print(auc)</span>
            <span class="n">eval_aucs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eval_aucs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="c1">#TODO Do this at once for train_stats, eval_stats, train_aucs and eval_aucs</span>
                <span class="n">eval_aucs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">eval_aucs</span><span class="p">,</span> <span class="n">config_counts</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
                <span class="n">eval_aucs_</span> <span class="o">=</span> <span class="n">eval_stats</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">eval_aucs_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="n">num_metrics</span><span class="p">:]</span> <span class="o">=</span> <span class="n">eval_aucs</span>
                <span class="n">eval_aucs</span> <span class="o">=</span> <span class="n">eval_aucs_</span>

                <span class="k">pass</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eval_aucs.shape:&quot;</span><span class="p">,</span> <span class="n">eval_aucs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


        <span class="c1"># -1 is added to ignore &quot;no. of stats that were saved&quot; as a dimension of difficulty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_counts</span> <span class="o">=</span> <span class="n">config_counts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dims_values</span> <span class="o">=</span> <span class="n">dims_values</span>

        <span class="c1"># Capture the dimensions that were varied, i.e. ones which had more than 1 value across experiments</span>
        <span class="n">x_axis_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x_tick_labels_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dims_varied</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_counts</span><span class="p">)):</span>
            <span class="k">if</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_names</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="c1"># ignore #seeds as dimensions of difficulty</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of seeds:&quot;</span><span class="p">,</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">x_axis_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">x_tick_labels_</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims_values</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_tick_labels_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_tick_labels_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="c1">#hack</span>
                        <span class="n">abridged_str</span> <span class="o">=</span> <span class="n">x_tick_labels_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">abridged_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                            <span class="n">abridged_str</span> <span class="o">=</span> <span class="n">abridged_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abridged_str</span><span class="p">)):</span>
                            <span class="k">if</span> <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span>
                                <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
                            <span class="k">elif</span> <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span>
                                <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
                            <span class="k">elif</span> <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;rotate&#39;</span><span class="p">:</span>
                                <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
                            <span class="k">elif</span> <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;flip&#39;</span><span class="p">:</span>
                                <span class="n">abridged_str</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
                            <span class="c1"># abridged_str[j] = abridged_str[j][:2]</span>
                        <span class="n">x_tick_labels_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">abridged_str</span><span class="p">)</span>
                <span class="n">dims_varied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x_tick_labels_</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No varying dims were found!&quot;</span><span class="p">)</span>
            <span class="n">x_tick_labels_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;single_config&#39;</span><span class="p">)</span>
            <span class="n">x_axis_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;single_config&#39;</span><span class="p">)</span>
            <span class="n">dims_varied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axis_labels</span> <span class="o">=</span> <span class="n">x_axis_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_labels</span> <span class="o">=</span> <span class="n">x_tick_labels_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dims_varied</span> <span class="o">=</span> <span class="n">dims_varied</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_axis_labels</span><span class="p">,</span> <span class="n">x_tick_labels_</span><span class="p">,</span> <span class="n">dims_varied</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimension varied:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s2">&quot;. The values it took:&quot;</span><span class="p">,</span> <span class="n">v</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span> <span class="o">+</span> <span class="s2">&quot; (1st 5 and last 5)&quot;</span><span class="p">,</span> <span class="s2">&quot;. Number of values it took:&quot;</span><span class="p">,</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;. Index in loaded data:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="c1"># experiment data</span>
        <span class="n">exp_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c1"># related to training &amp; eval data</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_stats</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_stats</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_curves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">stats_pd</span><span class="p">)</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_curves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_data_eval</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_aucs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_aucs</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_aucs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_aucs</span>

        <span class="c1"># related to plots</span>
        <span class="c1"># #TODO Remove the self from these since they are per expt. variables?</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_names</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;tick_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tick_labels</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_labels</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats_file</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;algorithm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;dims_varied&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims_varied</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;config_counts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_counts</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;final_rows_for_a_config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_rows_for_a_config</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;config_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_names</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;dims_values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims_values</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed_idx</span>
        <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;ts_idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_idx</span>

        <span class="k">return</span> <span class="n">exp_data</span></div>


    <span class="k">def</span> <span class="nf">gather_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_exp_data</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">,</span> <span class="n">use_aucs</span><span class="p">):</span>
        <span class="n">stats_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;agent&quot;</span><span class="p">:</span>
            <span class="c1">#groupby agent</span>
            <span class="n">groupby</span> <span class="o">=</span> <span class="s1">&#39;algorithm&#39;</span>
            <span class="n">sub_groupby</span> <span class="o">=</span> <span class="s1">&#39;axis_labels&#39;</span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;metric&quot;</span><span class="p">:</span>
            <span class="c1">#groupby metric</span>
            <span class="n">groupby</span> <span class="o">=</span> <span class="s1">&#39;axis_labels&#39;</span>
            <span class="n">sub_groupby</span> <span class="o">=</span> <span class="s1">&#39;algorithm&#39;</span>

        <span class="c1">#iterate and group data based on the their values eg. [&#39;SAC&#39;, &#39;TD3&#39;] or [&#39;action_space_max&#39;, &#39;time_unit&#39;]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        example of experiment data grouped by agent:</span>
<span class="sd">            {</span>
<span class="sd">            &lt;group_key&gt;</span>
<span class="sd">            &quot;SAC&quot;: {</span>
<span class="sd">                   &lt;sub_group_key&gt;</span>
<span class="sd">                   &quot;time_unit&quot;: {</span>
<span class="sd">                                &quot;to_plot_&quot;: [],</span>
<span class="sd">                                &quot;to_plot_std_&quot;: [],</span>
<span class="sd">                                ....</span>
<span class="sd">                                },</span>
<span class="sd">                   &quot;action_space_max&quot;: {</span>
<span class="sd">                                       &quot;to_plot_&quot;: [],</span>
<span class="sd">                                       &quot;to_plot_std_&quot;: [],</span>
<span class="sd">                                       ....</span>
<span class="sd">                                       },</span>
<span class="sd">                   ........</span>
<span class="sd">                   },</span>
<span class="sd">            &quot;TD3&quot;: {</span>
<span class="sd">                    ......</span>
<span class="sd">                   }</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">exp_data</span> <span class="ow">in</span> <span class="n">list_exp_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">train</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">use_aucs</span><span class="p">:</span>
                    <span class="n">stats</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_aucs&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stats</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_stats&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">use_aucs</span><span class="p">:</span>
                    <span class="n">stats</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_aucs&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stats</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_stats&#39;</span><span class="p">]</span>

            <span class="n">group_keys</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="n">groupby</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">group_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">group_keys</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">group_key</span> <span class="ow">in</span> <span class="n">group_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">group_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stats_data</span><span class="p">:</span>
                    <span class="c1"># if group_key is not alreay present initialize</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

                <span class="n">sub_group_keys</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="n">sub_groupby</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_group_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">sub_group_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_group_keys</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_group_keys</span><span class="p">)):</span>
                    <span class="n">sub_group_key</span> <span class="o">=</span> <span class="n">sub_group_keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">sub_group_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">]:</span>
                        <span class="c1"># if sub_group_key is not alreay present initialize</span>
                        <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>


                    <span class="c1"># gather data related to plot</span>
                    <span class="n">mean_data_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">])</span> <span class="c1"># the slice sub-selects the metric written in position metric_num from the &quot;last axis of diff. metrics that were written&quot; and then the axis of #seeds becomes axis=-1 ( before slice it was -2).</span>
                    <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">mean_data_</span><span class="p">)</span>

                    <span class="c1">#HACK traspose the array and choose first column elements always</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_plot_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_plot_</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                        <span class="n">new_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">)]</span>
                        <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">to_plot_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_axes</span><span class="p">))[:,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;to_plot_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_plot_</span>

                    <span class="n">std_dev_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">])</span> <span class="c1">#seed</span>
                    <span class="n">to_plot_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">std_dev_</span><span class="p">)</span>

                    <span class="c1">#HACK traspose the array and choose first column elements always</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_plot_std_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">to_plot_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">to_plot_std_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_axes</span><span class="p">))[:,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;to_plot_std_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_plot_std_</span>

                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_group_key</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;tick_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;tick_labels&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="n">groupby</span><span class="p">]</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;metric_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">]</span>
                    <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">stats_data</span>

<div class="viewcode-block" id="MDPP_Analysis.plot_1d_dimensions"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.plot_1d_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">plot_1d_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_exp_data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_aucs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metric_num</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;agent&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Plots 1-D bar plots across a single dimension with mean and std. dev.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        list_exp_data : list of experiment data of type &lt;dict&gt;</span>
<span class="sd">                   [ for more details refer load_data(), get_exp_data() ]</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            A flag used to save a PDF (default is False)</span>
<span class="sd">        train : bool, optional</span>
<span class="sd">            A flag used to insert either _train or _eval in the filename of the PDF (default is True)</span>
<span class="sd">        use_aucs : bool, optional</span>
<span class="sd">            A flag used to insert _aucs in the filename of the PDF (default is False)</span>
<span class="sd">        metric_num :</span>
<span class="sd">            allowed values-&gt; &#39;-1&#39; to plot episode mean lengths</span>
<span class="sd">                             &#39;-2&#39; to plot episode reward</span>
<span class="sd">        plot_type : string describing how to group data and plot, say based on agent or metric</span>
<span class="sd">            allowed values-&gt; [&#39;agent&#39; ,&#39;metric&#39;]</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">stats_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="n">list_exp_data</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">,</span> <span class="n">use_aucs</span><span class="p">)</span>

        <span class="c1">#plot</span>
        <span class="k">for</span> <span class="n">group_key</span> <span class="ow">in</span> <span class="n">stats_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># hard-coded value</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">/</span><span class="n">cols</span><span class="p">))</span> <span class="c1"># dynamically compute</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> <span class="c1"># default 12, for poster: 30</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">rows</span><span class="p">]</span>

            <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span> <span class="c1"># [n*1] or [n*2] grid</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sub_group_key</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cols</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1">#single row, single column plot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_bar</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">],</span> <span class="n">save_fig</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rows</span> <span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                    <span class="c1">#single row, multiple column plot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_bar</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">],</span> <span class="n">save_fig</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
                    <span class="n">j</span> <span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="c1">#multiple row, multiple column plot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_bar</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">],</span> <span class="n">save_fig</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="c1">#switch to next row 1st column</span>
                        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#switch to same row next column</span>
                        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># hide the blank plot (if any)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1">#axes[j].set_visible(False)</span>
                        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#axes[i, j].set_visible(False)</span>
                        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
            <span class="n">figure</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">group_key</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

            <span class="c1"># save figure</span>
            <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
                <span class="n">fig_name</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="p">(</span><span class="s1">&#39;_train&#39;</span> <span class="k">if</span> <span class="n">train</span> <span class="k">else</span> <span class="s1">&#39;_eval&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="s1">&#39;_aucs&#39;</span> <span class="k">if</span> <span class="n">use_aucs</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;_final_reward_&#39;</span> <span class="o">+</span> \
                        <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> \
                        <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;_1d.pdf&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MDPP_Analysis.plot_bar"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.plot_bar">[docs]</a>    <span class="k">def</span> <span class="nf">plot_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">stats_data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metric_num</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">bar_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Plots 1-D bar plots across a single dimension with mean and std. dev.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax: matplotlib axes instance to plot</span>
<span class="sd">        stats_data : dictionary type with data related to [&#39;train_stats&#39;, &#39;eval_stats&#39;, ...]</span>
<span class="sd">            [ for more details refer load_data(), get_exp_data() ]</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            A flag used to save a PDF (default is False)</span>
<span class="sd">        metric_num :</span>
<span class="sd">            allowed values-&gt; &#39;-1&#39; to plot episode mean lengths</span>
<span class="sd">                             &#39;-2&#39; to plot episode reward</span>
<span class="sd">        bar_color : the color of bars in plots</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">y_axis_label</span> <span class="o">=</span> <span class="s1">&#39;Reward&#39;</span> <span class="k">if</span> <span class="s1">&#39;reward&#39;</span> <span class="ow">in</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">]</span> <span class="k">else</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">]</span>

        <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;to_plot_&#39;</span><span class="p">]</span>
        <span class="n">to_plot_std_</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;to_plot_std_&#39;</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span>
        <span class="n">tick_labels</span> <span class="o">=</span>  <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;tick_labels&#39;</span><span class="p">]</span>
        <span class="n">axis_labels</span> <span class="o">=</span>  <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span>
        <span class="n">stats_file</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">))</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.8</span> <span class="c1"># bar width</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">to_plot_</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">to_plot_std_</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_color</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_axis_label</span><span class="p">)</span>
        <span class="c1">#ax.set_xlabel(axis_labels)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#ax.set_title(labels)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">)</span></div>


<div class="viewcode-block" id="MDPP_Analysis.plot_2d_heatmap"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.plot_2d_heatmap">[docs]</a>    <span class="k">def</span> <span class="nf">plot_2d_heatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_exp_data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric_num</span><span class="o">=-</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Plots 2 2-D heatmaps: 1 for mean and 1 for std. dev. across 2 dimensions of hardness of MDP Playground</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        list_exp_data : list of experiment data of type &lt;dict&gt;</span>
<span class="sd">                   [ for more details refer load_data(), get_exp_data() ]</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            A flag used to save a PDF (default is False)</span>
<span class="sd">        train : bool, optional</span>
<span class="sd">            A flag used to insert either _train or _eval in the filename of the PDF (default is True)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#HACK</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_exp_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">exp_data</span> <span class="o">=</span> <span class="n">list_exp_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#TODO make changes to handle multiple experiments plot</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>


        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span> <span class="c1"># default 12, 24 for paper, for poster: 30</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Purples&#39;</span> <span class="c1"># &#39;Blues&#39; #</span>
        <span class="n">label_</span> <span class="o">=</span> <span class="s1">&#39;Reward&#39;</span> <span class="k">if</span> <span class="s1">&#39;reward&#39;</span> <span class="ow">in</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">]</span> <span class="k">else</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">]</span>

        <span class="n">tick_labels</span> <span class="o">=</span>  <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;tick_labels&#39;</span><span class="p">]</span>
        <span class="n">axis_labels</span> <span class="o">=</span>  <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span>
        <span class="n">stats_file</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">train</span><span class="p">:</span>
            <span class="n">stats_data</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_stats&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stats_data</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_stats&#39;</span><span class="p">]</span>

        <span class="n">mean_data_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">])</span> <span class="c1">#seed</span>
        <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">mean_data_</span><span class="p">)</span>
        <span class="c1"># print(to_plot_)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_plot_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># warning.warn(&quot;Data contains variation in more than 2 dimensions (apart from seeds). May lead to plotting error!&quot;)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data contains variation in more than 2 dimensions (apart from seeds). This is currently not supported&quot;</span><span class="p">)</span> <span class="c1">#TODO Add 2-D plots for all combinations of 2 varying dims?</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">to_plot_</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">to_plot_</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1"># default 15, for poster: 25</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label_</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">stats_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;_train&#39;</span> <span class="k">if</span> <span class="n">train</span> <span class="k">else</span> <span class="s1">&#39;_eval&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_final_reward_mean_heat_map_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">std_dev_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">])</span> <span class="c1">#seed</span>
        <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">std_dev_</span><span class="p">)</span>
        <span class="c1"># print(to_plot_, to_plot_.shape)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">to_plot_</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">to_plot_</span><span class="p">))</span> <span class="c1"># 60 for DQN, 100 for A3C</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tick_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1"># default 15, for poster: 30</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Reward Std Dev.&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># plt.tight_layout()</span>
        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">stats_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;_train&#39;</span> <span class="k">if</span> <span class="n">train</span> <span class="k">else</span> <span class="s1">&#39;_eval&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_final_reward_std_heat_map_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="c1"># plt.savefig(stats_file.split(&#39;/&#39;)[-1] + &#39;_train_heat_map.png&#39;)#, dpi=300)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MDPP_Analysis.plot_learning_curves"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.plot_learning_curves">[docs]</a>    <span class="k">def</span> <span class="nf">plot_learning_curves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_exp_data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric_num</span><span class="o">=-</span><span class="mi">2</span><span class="p">):</span> <span class="c1"># metric_num needs to be minus indexed because stats_pd reutrned for train stats has _all_ columns</span>
        <span class="sd">&#39;&#39;&#39;Plots learning curves: Either across 1 or 2 dimensions of hardness of MDP Playground. Different colours represent learning curves for different seeds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        list_exp_data : list of experiment data of type &lt;dict&gt;</span>
<span class="sd">                   [ for more details refer load_data(), get_exp_data() ]</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            A flag used to save a PDF (default is False)</span>
<span class="sd">        train : bool, optional</span>
<span class="sd">            A flag used to insert either _train or _eval in the filename of the PDF (default is True)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#HACK</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_exp_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">exp_data</span> <span class="o">=</span> <span class="n">list_exp_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#TODO make changes to handle multiple experiments plot</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using only 1st expt. for the foll. plots&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>


        <span class="n">stats_file</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span>
        <span class="n">dims_varied</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;dims_varied&#39;</span><span class="p">]</span>
        <span class="n">config_counts</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;config_counts&#39;</span><span class="p">]</span>
        <span class="n">config_names</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;config_names&#39;</span><span class="p">]</span>
        <span class="n">dims_values</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;dims_values&#39;</span><span class="p">]</span>
        <span class="n">final_rows_for_a_config</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;final_rows_for_a_config&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">train</span><span class="p">:</span>
            <span class="n">stats_data</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;train_curves&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stats_data</span> <span class="o">=</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;eval_curves&#39;</span><span class="p">]</span>

        <span class="c1"># Plot for train metrics: learning curves; with subplot</span>
        <span class="c1"># Comment out unneeded labels in code lines 41-44 in this cell</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims_varied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ncols_</span> <span class="o">=</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">nrows_</span> <span class="o">=</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ncols_</span> <span class="o">=</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">nrows_</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">nseeds_</span> <span class="o">=</span> <span class="n">config_counts</span><span class="p">[</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;seed_idx&#39;</span><span class="p">]]</span><span class="c1">#self.config_counts[-1]</span>
        <span class="c1"># print(ax, type(ax), type(ax[0]))</span>
    <span class="c1">#color_cycle = plt.rcParams[&#39;axes.prop_cycle&#39;].by_key()[&#39;color&#39;]</span>
        <span class="c1"># print(&quot;color_cycle&quot;, color_cycle)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">})</span> <span class="c1"># 25 for 36x21 fig, 16 for 24x14 fig.</span>
        <span class="c1"># 36x21 for better resolution but about 900kb file size, 24x14 for okay resolution and 550kb file size</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows_</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols_</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="n">ncols_</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">nrows_</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="c1"># metrics_reshaped_squeezed = np.squeeze(metrics_reshaped)</span>
        <span class="c1"># print(np.squeeze(metrics_reshaped).shape)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final_rows_for_a_config</span><span class="p">)):</span>
            <span class="n">i_index</span> <span class="o">=</span> <span class="n">i</span><span class="o">//</span><span class="p">(</span><span class="n">nseeds_</span> <span class="o">*</span> <span class="n">ncols_</span><span class="p">)</span> <span class="c1"># = num_seeds * shape of more frequently changing hyperparam</span>
            <span class="n">j_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="n">nseeds_</span><span class="p">)</span> <span class="o">%</span> <span class="n">ncols_</span> <span class="c1">#</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">]</span>
                <span class="n">to_plot_x</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;ts_idx&#39;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">to_plot_</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">]</span>
                <span class="n">to_plot_x</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">final_rows_for_a_config</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;ts_idx&#39;</span><span class="p">]]</span>
            <span class="c1"># print(to_plot_[-1])</span>
        <span class="c1">#     if i % 10 == 0:</span>
        <span class="c1">#         fig = plt.figure(figsize=(12, 7))</span>
        <span class="c1">#     print(i//50, (i//10) % 5)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i_index</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">to_plot_x</span><span class="p">,</span> <span class="n">to_plot_</span><span class="p">,</span> <span class="n">rasterized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="c1">#, label=&quot;Seq len&quot; + str(seq_lens[i//10]))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">nseeds_</span> <span class="o">==</span> <span class="n">nseeds_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># 10 is num. of seeds</span>
        <span class="c1">#         pass</span>
        <span class="c1">#         print(&quot;Plot no.&quot;, i//10)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i_index</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Train Timesteps&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i_index</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Reward&quot;</span><span class="p">)</span>
        <span class="c1">#         ax[i_index][j_index].set_title(&#39;Delay &#39; + str(delays[i_index]) + &#39;, Sequence Length &#39; + str(sequence_lengths[j_index]))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims_varied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">title_1st_dim</span> <span class="o">=</span> <span class="n">config_names</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dims_values</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">i_index</span><span class="p">])</span>
                    <span class="n">title_2nd_dim</span> <span class="o">=</span> <span class="n">config_names</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dims_values</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">j_index</span><span class="p">])</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i_index</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_1st_dim</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">title_2nd_dim</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">title_1st_dim</span> <span class="o">=</span> <span class="n">config_names</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dims_values</span><span class="p">[</span><span class="n">dims_varied</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">j_index</span><span class="p">])</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i_index</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_1st_dim</span><span class="p">)</span>
        <span class="c1">#         ax[i_index][j_index].set_title(&#39;Sequence Length &#39; + str(seq_lens[j_index]))</span>
        <span class="c1">#         ax[i_index][j_index].set_title(&#39;Reward Density &#39; + str(reward_densities[j_index]))</span>

        <span class="c1">#         plt.legend(loc=&#39;upper left&#39;, prop={&#39;size&#39;: 26})</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="c1"># plt.suptitle(&quot;Training Learning Curves&quot;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">stats_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;_train&#39;</span> <span class="k">if</span> <span class="n">train</span> <span class="k">else</span> <span class="s1">&#39;_eval&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_learning_curves_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">exp_data</span><span class="p">[</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span> <span class="c1"># Generates high quality vector graphic PDF 125kb; dpi doesn&#39;t matter for this</span></div>

    <span class="c1">###### ---------- radar (spider) plot ------------- ######</span>
<div class="viewcode-block" id="MDPP_Analysis.plot_radar"><a class="viewcode-back" href="../../../_autosummary/mdp_playground.analysis.analysis.MDPP_Analysis.html#mdp_playground.analysis.analysis.MDPP_Analysis.plot_radar">[docs]</a>    <span class="k">def</span> <span class="nf">plot_radar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_exp_data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric_num</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">{},</span> <span class="n">use_aucs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Plots radar (spider) chart across different dimensions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        list_exp_data : list of experiment data of type &lt;dict&gt;</span>
<span class="sd">                   [ for more details refer load_data(), get_exp_data() ]</span>
<span class="sd">        save_fig : bool, optional</span>
<span class="sd">            A flag used to save a PDF (default is False)</span>
<span class="sd">        train : bool, optional</span>
<span class="sd">            A flag used to insert either _train or _eval in the filename of the PDF (default is True)</span>
<span class="sd">        metric_num :</span>
<span class="sd">            allowed values-&gt; &#39;-1&#39; to plot episode mean lengths</span>
<span class="sd">                             &#39;-2&#39; to plot episode reward</span>
<span class="sd">        use_aucs : bool, optional</span>
<span class="sd">            A flag used to insert _aucs in the filename of the PDF (default is False)</span>
<span class="sd">        plot_type : string describing how to group data and plot, say based on agent or metric</span>
<span class="sd">            allowed values-&gt; [&#39;agent&#39; ,&#39;metric&#39;]</span>
<span class="sd">        weights : dictionary of weights associated per dimension (plot_type) data</span>
<span class="sd">            eg weights[&#39;reward_noise&#39;] = [.25, .25, .25, .25]</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">stats_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="n">list_exp_data</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">metric_num</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">,</span> <span class="n">use_aucs</span><span class="p">)</span>

        <span class="c1"># get axes labels</span>
        <span class="n">first_group</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">stats_data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">spoke_labels</span> <span class="o">=</span> <span class="n">first_group</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c1">#plot</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spoke_labels</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">radar_chart</span><span class="o">.</span><span class="n">radar_factory</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;radar&#39;</span><span class="p">)</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">group_key</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">stats_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">sub_group_key</span> <span class="ow">in</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;to_plot_&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sub_group_key</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">sub_group_key</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

        <span class="c1"># customize plot axis labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_varlabels</span><span class="p">(</span><span class="n">spoke_labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_rlabel_position</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">stats_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">.95</span><span class="p">),</span> <span class="n">labelspacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="c1"># save figure</span>
        <span class="k">if</span> <span class="n">save_fig</span><span class="p">:</span>
            <span class="n">fig_name</span> <span class="o">=</span> <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;stats_file&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="p">(</span><span class="s1">&#39;_train&#39;</span> <span class="k">if</span> <span class="n">train</span> <span class="k">else</span> <span class="s1">&#39;_eval&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="s1">&#39;_aucs&#39;</span> <span class="k">if</span> <span class="n">use_aucs</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_final_reward_&#39;</span> <span class="o">+</span> \
                        <span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;axis_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> \
                        <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stats_data</span><span class="p">[</span><span class="n">group_key</span><span class="p">][</span><span class="n">sub_group_key</span><span class="p">][</span><span class="s1">&#39;metric_names&#39;</span><span class="p">][</span><span class="n">metric_num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;_spider.pdf&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>
</pre></div>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By MDP Playground developers<br/>
        
            &copy; Copyright 2021, MDP Playground developers.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>